"use strict";
import { cancelOnFrameUpdate, onFrameUpdate } from 'framesync';
import action from '../../action';
import listen from '../listen';
import { defaultPointerPos, eventToPoint } from '../pointer/utils';
var point = defaultPointerPos();
var isMouseDevice = false;
if (typeof document !== 'undefined') {
    var updatePointLocation = function (e) {
        isMouseDevice = true;
        eventToPoint(e, point);
    };
    listen(document, 'mousedown mousemove', true)
        .start(updatePointLocation);
}
var mouse = function (_a) {
    var _b = (_a === void 0 ? {} : _a).preventDefault, preventDefault = _b === void 0 ? true : _b;
    return action(function (_a) {
        var update = _a.update;
        var updatePoint = function () { return update(point); };
        var onMove = function (e) {
            if (preventDefault)
                e.preventDefault();
            onFrameUpdate(updatePoint);
        };
        var updateOnMove = listen(document, 'mousemove').start(onMove);
        if (isMouseDevice)
            onFrameUpdate(updatePoint);
        return {
            stop: function () {
                cancelOnFrameUpdate(updatePoint);
                updateOnMove.stop();
            }
        };
    });
};
export default mouse;
//# sourceMappingURL=mouse.js.map