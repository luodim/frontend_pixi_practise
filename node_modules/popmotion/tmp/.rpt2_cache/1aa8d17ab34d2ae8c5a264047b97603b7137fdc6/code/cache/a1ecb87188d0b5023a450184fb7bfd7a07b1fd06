{"code":"import { onFrameUpdate } from \"framesync\";\r\nimport action from \"../action\";\r\nvar multi = function (_a) {\r\n    var getCount = _a.getCount, getFirst = _a.getFirst, getOutput = _a.getOutput, mapApi = _a.mapApi, setProp = _a.setProp, startActions = _a.startActions;\r\n    return function (actions) {\r\n        return action(function (_a) {\r\n            var update = _a.update, complete = _a.complete, error = _a.error;\r\n            var numActions = getCount(actions);\r\n            var output = getOutput();\r\n            var updateOutput = function () { return update(output); };\r\n            var numCompletedActions = 0;\r\n            var subs = startActions(actions, function (a, name) {\r\n                var hasCompleted = false;\r\n                return a.start({\r\n                    complete: function () {\r\n                        if (!hasCompleted) {\r\n                            hasCompleted = true;\r\n                            numCompletedActions++;\r\n                            if (numCompletedActions === numActions)\r\n                                onFrameUpdate(complete);\r\n                        }\r\n                    },\r\n                    error: error,\r\n                    update: function (v) {\r\n                        setProp(output, name, v);\r\n                        onFrameUpdate(updateOutput, true);\r\n                    }\r\n                });\r\n            });\r\n            return Object.keys(getFirst(subs)).reduce(function (api, methodName) {\r\n                api[methodName] = mapApi(subs, methodName);\r\n                return api;\r\n            }, {});\r\n        });\r\n    };\r\n};\r\nexport default multi;\r\n//# sourceMappingURL=multi.js.map","map":"{\"version\":3,\"file\":\"multi.js\",\"sourceRoot\":\"\",\"sources\":[\"../src/compositors/multi.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,aAAa,EAAE,MAAM,WAAW,CAAC;AAC1C,OAAO,MAAkB,MAAM,WAAW,CAAC;AAc3C,IAAM,KAAK,GAAG,UAAa,EAOF;QANvB,sBAAQ,EACR,sBAAQ,EACR,wBAAS,EACT,kBAAM,EACN,oBAAO,EACP,8BAAY;IACgB,OAAA,UAAC,OAAU;QACvC,OAAA,MAAM,CAAC,UAAC,EAA2B;gBAAzB,kBAAM,EAAE,sBAAQ,EAAE,gBAAK;YAC/B,IAAM,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;YACrC,IAAM,MAAM,GAAG,SAAS,EAAE,CAAC;YAC3B,IAAM,YAAY,GAAG,cAAM,OAAA,MAAM,CAAC,MAAM,CAAC,EAAd,CAAc,CAAC;YAC1C,IAAI,mBAAmB,GAAG,CAAC,CAAC;YAE5B,IAAM,IAAI,GAAG,YAAY,CAAC,OAAO,EAAE,UAAC,CAAC,EAAE,IAAI;gBACzC,IAAI,YAAY,GAAG,KAAK,CAAC;gBACzB,OAAO,CAAC,CAAC,KAAK,CAAC;oBACb,QAAQ,EAAE;wBACR,IAAI,CAAC,YAAY,EAAE;4BACjB,YAAY,GAAG,IAAI,CAAC;4BACpB,mBAAmB,EAAE,CAAC;4BACtB,IAAI,mBAAmB,KAAK,UAAU;gCAAE,aAAa,CAAC,QAAQ,CAAC,CAAC;yBACjE;oBACH,CAAC;oBACD,KAAK,OAAA;oBACL,MAAM,EAAE,UAAC,CAAM;wBACb,OAAO,CAAC,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;wBACzB,aAAa,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;oBACpC,CAAC;iBACF,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;YAEH,OAAO,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,CACvC,UAAC,GAAgC,EAAE,UAAU;gBAC3C,GAAG,CAAC,UAAU,CAAC,GAAG,MAAM,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;gBAC3C,OAAO,GAAG,CAAC;YACb,CAAC,EACD,EAAE,CACH,CAAC;QACJ,CAAC,CAAC;IA/BF,CA+BE;AAhC0B,CAgC1B,CAAC;AAEL,eAAe,KAAK,CAAC\"}"}
